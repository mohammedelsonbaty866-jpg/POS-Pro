<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…Ø­Ø§Ø³Ø¨ÙŠ Ø´Ø§Ù…Ù„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="manifest" href="manifest.json">
  
  <style>
    body {
      font-family: Tahoma, Arial;
      background: #f4f6f8;
      margin: 0;
    }

    header {
      background: #0d6efd;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
    }

    nav {
      display: flex;
      background: #ffffff;
      border-bottom: 1px solid #ddd;
    }

    nav button {
      flex: 1;
      padding: 12px;
      border: none;
      background: none;
      font-size: 16px;
      cursor: pointer;
    }

    nav button.active {
      background: #0d6efd;
      color: white;
    }

    .container {
      padding: 15px;
    }

    .box {
      background: white;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 5px;
    }

    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      font-size: 16px;
    }

    button.primary {
      background: #0d6efd;
      color: white;
      border: none;
      margin-top: 10px;
    }
  </style>
</head>

<body>

<header>
  ğŸ“Š Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…Ø­Ø§Ø³Ø¨ÙŠ Ø´Ø§Ù…Ù„
</header>

<nav>
  <button class="active" onclick="showSection('dashboard')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button onclick="showSection('purchases')">Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</button>
  <button onclick="showSection('products')">Ø§Ù„Ø£ØµÙ†Ø§Ù</button>
  <button onclick="showSection('sales')">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</button>
  <button onclick="showSection('reports')">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
  <button onclick="showSection('expenses')">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</button>
  <button onclick="showSection('settings')">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
</nav>

<div class="container">

  <!-- Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
  <div id="dashboard" class="box">
    <h3>Ù…Ø±Ø­Ø¨Ù‹Ø§ ğŸ‘‹</h3>
    <p>Ø§Ø®ØªØ± Ù‚Ø³Ù… Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„.</p>
  </div>

  <!-- Ø§Ù„Ø£ØµÙ†Ø§Ù -->
  <div id="products" class="box" style="display:none;">
    <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù</h3>
    <input id="productName" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
    <input id="productPrice" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹">
    <input id="productQty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
    <button class="primary" onclick="addProduct()">â• Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
    <div id="productList"></div>
  </div>

  <!-- Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª -->
  <div id="sales" class="box" style="display:none;">
  <h3>ğŸ§¾ ÙØ§ØªÙˆØ±Ø© Ø¨ÙŠØ¹</h3>

  <label>Ø§Ù„ØµÙ†Ù</label>
  <select id="saleProduct"></select>

  <label>Ø§Ù„ÙƒÙ…ÙŠØ©</label>
  <input type="number" id="saleQty" value="1" min="1">

  <button class="primary" onclick="addToInvoice()">â• Ø¥Ø¶Ø§ÙØ© Ù„Ù„ÙØ§ØªÙˆØ±Ø©</button>

  <hr>

  <div id="invoiceItems"></div>

  <hr>

  <p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <b id="subTotal">0</b></p>
  <p id="taxRow" style="display:none;">Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©: <b id="taxAmount">0</b></p>
  <p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: <b id="grandTotal">0</b></p>
<button onclick="printInvoice()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
  <button class="primary" onclick="saveInvoice()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
</div>
<div id="purchases" class="box" style="display:none;">
  <h3>ğŸ§¾ ÙØ§ØªÙˆØ±Ø© Ø´Ø±Ø§Ø¡</h3>

  <label>Ø§Ù„ØµÙ†Ù</label>
  <select id="purchaseProduct"></select>

  <label>Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</label>
  <input id="newProductName" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯">

  <label>Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡</label>
  <input type="number" id="purchasePrice">

  <label>Ø§Ù„ÙƒÙ…ÙŠØ©</label>
  <input type="number" id="purchaseQty" value="1">

  <button class="primary" onclick="addPurchase()">â• Ø¥Ø¶Ø§ÙØ©</button>

  <hr>
  <div id="purchaseItems"></div>

  <hr>
  <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©: <b id="purchaseTotal">0</b></p>

  <button class="primary" onclick="savePurchase()">ğŸ’¾ Ø­ÙØ¸ ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡</button>
</div>
  <!-- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
  <div id="reports" class="box" style="display:none;">
  <h3>ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h3>

  <button onclick="showSalesReport()">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</button>
  <button onclick="showProfitReport()">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</button>
  <button onclick="showStockReport()">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</button>

  <div id="reportResult"></div>
</div>

  <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
  <div id="settings" class="box" style="display:none;">
    <h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>

    <label>
      ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©
      <select id="taxEnabled">
        <option value="false">Ù„Ø§</option>
        <option value="true">Ù†Ø¹Ù…</option>
      </select>
    </label>

    <input id="taxRate" type="number" placeholder="Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© %" />

    <button class="primary" onclick="saveSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
  </div>

</div>

<script>
  function showSection(id) {
    document.querySelectorAll('.box').forEach(div => div.style.display = 'none');
    document.getElementById(id).style.display = 'block';

    document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
  }

  let products = JSON.parse(localStorage.getItem('products') || '[]');

  function addProduct() {
    const name = productName.value;
    const price = productPrice.value;
    const qty = productQty.value;

    if (!name || !price || !qty) {
      alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
      return;
    }

    products.push({ name, price, qty });
    localStorage.setItem('products', JSON.stringify(products));
    productName.value = productPrice.value = productQty.value = '';
    renderProducts();
  }

  function renderProducts() {
    productList.innerHTML = '';
    products.forEach((p, i) => {
      productList.innerHTML += `
        <div class="box">
          <b>${p.name}</b><br>
          Ø§Ù„Ø³Ø¹Ø±: ${p.price} | Ø§Ù„ÙƒÙ…ÙŠØ©: ${p.qty}
        </div>
      `;
    });
  }
  <div id="expenses" class="box" style="display:none;">
  <h3>ğŸ’¸ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h3>

  <label>Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙ</label>
  <select id="expenseType">
    <option>Ø¥ÙŠØ¬Ø§Ø±</option>
    <option>ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option>
    <option>Ù…ÙŠØ§Ù‡</option>
    <option>Ø±ÙˆØ§ØªØ¨</option>
    <option>Ø£Ø®Ø±Ù‰</option>
  </select>

  <label>Ø§Ù„ÙˆØµÙ</label>
  <input id="expenseDesc" placeholder="ÙˆØµÙ Ø§Ù„Ù…ØµØ±ÙˆÙ">

  <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
  <input type="number" id="expenseAmount">

  <button class="primary" onclick="addExpense()">â• Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ</button>

  <hr>
  <div id="expenseList"></div>
</div>

  function saveSettings() {
    const settings = {
      taxEnabled: taxEnabled.value === 'true',
      taxRate: taxRate.value
    };
    localStorage.setItem('settings', JSON.stringify(settings));
    alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª âœ…');
  }

  renderProducts();
</script>
<script>
  let invoice = [];
  let sales = JSON.parse(localStorage.getItem('sales') || '[]');
  let settings = JSON.parse(localStorage.getItem('settings') || '{}');

  function loadProductsToSales() {
    saleProduct.innerHTML = '';
    products.forEach((p, i) => {
      saleProduct.innerHTML += `<option value="${i}">${p.name} - ${p.price}</option>`;
    });
  }

  function addToInvoice() {
    const index = saleProduct.value;
    const qty = parseInt(saleQty.value);

    if (!products[index] || qty <= 0) return;

    const product = products[index];

    invoice.push({
      name: product.name,
      price: Number(product.price),
      qty,
      total: product.price * qty
    });

    renderInvoice();
  }

  function renderInvoice() {
    invoiceItems.innerHTML = '';
    let subtotal = 0;

    invoice.forEach(item => {
      subtotal += item.total;
      invoiceItems.innerHTML += `
        <div class="box">
          ${item.name} Ã— ${item.qty} = ${item.total}
        </div>
      `;
    });

    subTotal.innerText = subtotal.toFixed(2);

    let tax = 0;
    if (settings.taxEnabled) {
      tax = subtotal * (settings.taxRate / 100);
      taxRow.style.display = 'block';
      taxAmount.innerText = tax.toFixed(2);
    } else {
      taxRow.style.display = 'none';
    }

    grandTotal.innerText = (subtotal + tax).toFixed(
      <script>
      <script>
function printInvoice() {
  let html = `
    <h2>ÙØ§ØªÙˆØ±Ø© Ø¨ÙŠØ¹</h2>
    <hr>
  `;

  invoice.forEach(i => {
    html += `<p>${i.name} Ã— ${i.qty} = ${i.total}</p>`;
  });

  html += `
    <hr>
    <p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${subTotal.innerText}</p>
    <p>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©: ${settings.taxEnabled ? taxAmount.innerText : 0}</p>
    <h3>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${grandTotal.innerText}</h3>
  `;

  const w = window.open('', '', 'width=400,height=600');
  w.document.write(html);
  w.print();
}
</script>
<script>
function showSalesReport() {
  let total = 0;
  reportResult.innerHTML = '<h4>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h4>';

  sales.forEach(s => {
    total += Number(s.total);
    reportResult.innerHTML += `
      <div class="box">
        ÙØ§ØªÙˆØ±Ø© #${s.id}<br>
        Ø§Ù„ØªØ§Ø±ÙŠØ®: ${s.date}<br>
        Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${s.total}
      </div>
    `;
  });

  reportResult.innerHTML += `<h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: ${total}</h3>`;
}

function showProfitReport() {
  let profit = 0;
  reportResult.innerHTML = '<h4>Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</h4>';

  sales.forEach(s => {
    s.items.forEach(i => {
      profit += i.total;
    });
  });

  reportResult.innerHTML += `<h3>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ: ${profit}</h3>`;
}

function showStockReport() {
  reportResult.innerHTML = '<h4>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h4>';

  products.forEach(p => {
    reportResult.innerHTML += `
      <div class="box">
        ${p.name}<br>
        Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${p.qty}
      </div>
    `;
  });
}
</script>
<script>
function printInvoice() {
  let html = `
    <h2>ÙØ§ØªÙˆØ±Ø© Ø¨ÙŠØ¹</h2>
    <hr>
  `;

  invoice.forEach(i => {
    html += `<p>${i.name} Ã— ${i.qty} = ${i.total}</p>`;
  });

  html += `
    <hr>
    <p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${subTotal.innerText}</p>
    <p>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©: ${settings.taxEnabled ? taxAmount.innerText : 0}</p>
    <h3>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${grandTotal.innerText}</h3>
  `;

  const w = window.open('', '', 'width=400,height=600');
  w.document.write(html);
  w.print();
}
</script>
  <script>
let purchases = JSON.parse(localStorage.getItem('purchases') || '[]');
let purchaseInvoice = [];

function loadProductsToPurchases() {
  purchaseProduct.innerHTML = '<option value="">-- Ø§Ø®ØªØ± ØµÙ†Ù --</option>';
  products.forEach((p, i) => {
    purchaseProduct.innerHTML += `<option value="${i}">${p.name}</option>`;
  });
}

function addPurchase() {
  const existingIndex = purchaseProduct.value;
  const newName = newProductName.value.trim();
  const price = Number(purchasePrice.value);
  const qty = Number(purchaseQty.value);

  if ((!existingIndex && !newName) || price <= 0 || qty <= 0) {
    alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
    return;
  }

  let name = newName;
  let product;

  if (existingIndex !== '') {
    product = products[existingIndex];
    name = product.name;
  }

  purchaseInvoice.push({
    name,
    price,
    qty,
    total: price * qty
  });

  renderPurchaseInvoice();

  newProductName.value = '';
  purchasePrice.value = '';
  purchaseQty.value = 1;
}

function renderPurchaseInvoice() {
  purchaseItems.innerHTML = '';
  let total = 0;

  purchaseInvoice.forEach(i => {
    total += i.total;
    purchaseItems.innerHTML += `
      <div class="box">
        ${i.name} Ã— ${i.qty} = ${i.total}
      </div>
    `;
  });

  purchaseTotal.innerText = total.toFixed(2);
}

function savePurchase() {
  if (purchaseInvoice.length === 0) {
    alert('ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ ÙØ§Ø±ØºØ©');
    return;
  }

  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
  purchaseInvoice.forEach(item => {
    let product = products.find(p => p.name === item.name);

    if (product) {
      product.qty += item.qty;
      product.price = item.price; // Ø¢Ø®Ø± Ø³Ø¹Ø± Ø´Ø±Ø§Ø¡
    } else {
      products.push({
        name: item.name,
        price: item.price,
        qty: item.qty
      });
    }
  });

  localStorage.setItem('products', JSON.stringify(products));

  purchases.push({
    id: Date.now(),
    items: purchaseInvoice,
    total: purchaseTotal.innerText,
    date: new Date().toLocaleString('ar-EG')
  });

  localStorage.setItem('purchases', JSON.stringify(purchases));

  purchaseInvoice = [];
  renderPurchaseInvoice();
  renderProducts();
  loadProductsToSales();
  loadProductsToPurchases();

  alert('ØªÙ… Ø­ÙØ¸ ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø²ÙˆÙ† âœ…');
}
</script>
</script>
</body>
</html>
